* Installation instructions
#+BEGIN_EXAMPLE
Set-ExecutionPolicy RemoteSigned -Scope Process

iex (new-object net.webclient).downloadstring('https://get.scoop.sh')

pause

scoop install git
$scoop=Resolve-Path "$(scoop prefix scoop)\..\..\.."
git clone https://github.com/pcrama/windows-workstation-configuration.git -o https-origin "$scoop\persist"

Write-Host "Pull https://github.com/lukesampson/scoop/pull/1934"
scoop update
# The prior update makes the apps\scoop\current directory into a .git working directory so that we can pull into it
cd "$scoop\apps\scoop\current"
git remote add pcrama-https https://github.com/pcrama/scoop.git
git config --local user.name "Philippe Crama"
git config --local user.email "dontsendmespam@example.com"

scoop bucket add extras

Write-Host "Pull https://github.com/lukesampson/scoop-extras/pull/731"
cd "$scoop\buckets\extras"
git remote add pcrama-https https://github.com/pcrama/scoop-extras.git
git config --local user.name "Philippe Crama"
git config --local user.email "dontsendmespam@example.com"
git fetch pcrama-https master
git merge pcrama-https/master

scoop bucket add scoop-buckets https://github.com/pcrama/scoop-buckets.git

pause
scoop install zip conemu ditto fd ripgrep smallcliutils greenshot keypirinha emacs

scoop install multicommander
# Fix up some directories that are not under source control
$multicmdsrc="$scoop\apps\multicommander\current\Config.original"
$multicmdest="$scoop\persist\multicommander\Config"
Copy-Item -Path "$multicmdsrc\TOTD" -Destination "$multicmdest" -Recurse
Copy-Item -Path "$multicmdsrc\Presets" -Destination "$multicmdest" -Recurse
Copy-Item -Path "$multicmdsrc\CfgProfiles" -Destination "$multicmdest" -Recurse

scoop bucket add versions
scoop install -a 32bit python27
scoop install -a 32bit tomcat

scoop install dngrep dview sumatrapdf plantuml pdftk unison workrave flux jpegview winmerge paint.net smartty

. "$scoop\persist\_general\makeshortcut.ps1"
#+END_EXAMPLE

PS C:\Users\cramaph1\scoop> scoop list
Installed apps:

  7zip 18.05
  autoit 3.3.14.5
  autoruns 13.82 [extras]
  conemu 18.04.29 [extras]
  ditto 3.21.223.0 [extras]
  dngrep 2.8.16.0 [scoop-buckets]
  dview 1.7.2 [scoop-buckets]
  emax64 20180529 [scoop-buckets]
  fd 7.0.0
  flux 4.72 [extras]
  foxit-reader 9.1.0.5096 [extras]
  git 2.17.1.windows.2
  graphviz 2.38
  greenshot 1.2.10.6 [extras]
  idris 1.3.0
  innounp 0.46
  jpegview 1.0.37 [extras]
  keypirinha 2.18.2 [extras]
  multicommander 8.1.0.2452 [scoop-buckets]
  paint.net 4.0.21 [extras]
  pdftk 2.02
  plantuml 1.2018.6 [extras]
  procexp 16.21 [extras]
  putty 0.70 [extras]
  python27 2.7.14 [versions] {32bit}
  ripgrep 0.8.1
  smallcliutils 2 [scoop-buckets]
  smartty 3.1 [extras]
  sumatrapdf 3.1.2 [extras]
  tomcat 8.5.28 [extras] {32bit}
  unison 2.48.4 [scoop-buckets]
  vifm 0.9.1 [extras]
  winmerge 2.14.0 [extras]
  workrave 1.10.1 [scoop-buckets]
  zip 3.0

* Other setup actions to investigate
** TODO Setting a mouse trail
- [[https://msdn.microsoft.com/en-us/library/ms724947(v=VS.85).aspx][MSDN for SystemParametersInfo]]:
  - ~SPI_SETMOUSETRAILS~
  - ~SPI_SETMOUSESONAR~
  - ~SPI_SETMOUSEVANISH~
- [[http://www.strichnet.com/edit-and-apply-registry-settings-via-powershell/][How to call SystemParametersInfo from Powershell]]
* Setting up with git-sdk-64
** Git SDK (MINGW64 + MSYS2)
#+BEGIN_EXAMPLE
  $gitZip = "git-sdk-64-master.zip"
  $gitDest = "C:\gitsdk"
  [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
  (New-Object System.Net.WebClient).DownloadFile("https://github.com/git-for-windows/git-sdk-64/archive/master.zip", $gitZip)
  Add-Type -assembly "system.io.compression.filesystem"
  [io.compression.zipfile]::ExtractToDirectory($gitZip, "C:\")
  Move-Item C:\git-sdk-64-master\ $gitDest
  & "$gitDest\msys2_shell.cmd" -msys2 -mintty -c "pacman -Syu"
  & "$gitDest\msys2_shell.cmd" -msys2 -mintty -c "pacman -Syu" # 2nd time to make sure
  & "$gitDest\msys2_shell.cmd" -msys2 -mintty -c "for p in MINGW-packages MSYS2-packages ; do sdk cd `$p ; done"
#+END_EXAMPLE

** Scoop
*** Scoop installation & setup
#+BEGIN_EXAMPLE
  Set-ExecutionPolicy RemoteSigned -Scope Process
  iex (new-object net.webclient).downloadstring('https://get.scoop.sh')
  $Env:PATH += ";$gitDest\cmd"
  scoop update
  $scoop = Resolve-Path "$(scoop prefix scoop)\..\..\.."
  git clone https://github.com/pcrama/windows-workstation-configuration.git -o https-origin "$scoop\persist"
  cd "$scoop\persist"
  git config --local user.name "Philippe Crama"
  git config --local user.email "dontsendmespam@example.com"
  scoop bucket add extras
  scoop bucket add scoop-buckets https://github.com/pcrama/scoop-buckets.git
#+END_EXAMPLE

*** Install some apps
#+BEGIN_EXAMPLE
  scoop virustotal 7zip zip conemu ditto fd ripgrep smallcliutils greenshot keypirinha emax64 wincompose
  scoop install 7zip zip conemu ditto fd ripgrep smallcliutils greenshot keypirinha emax64 wincompose
#+END_EXAMPLE

*** Multicommander
#+BEGIN_EXAMPLE
  scoop install multicommander
  # Fix up some directories that are not under source control
  $multicmdsrc="$scoop\apps\multicommander\current\Config.original"
  $multicmdest="$scoop\persist\multicommander\Config"
  Copy-Item -Path "$multicmdsrc\TOTD" -Destination "$multicmdest" -Recurse
  Copy-Item -Path "$multicmdsrc\Presets" -Destination "$multicmdest" -Recurse
  Copy-Item -Path "$multicmdsrc\CfgProfiles" -Destination "$multicmdest" -Recurse
#+END_EXAMPLE

*** Python + Tomcat (?) 32 bit
#+BEGIN_EXAMPLE
  scoop bucket add versions
  scoop install -a 32bit python27
  # scoop install -a 32bit tomcat
#+END_EXAMPLE

*** More applications
#+BEGIN_EXAMPLE
  scoop install sumatrapdf plantuml unison workrave flux jpegview meld
#+END_EXAMPLE

*** NOT installed
#+BEGIN_EXAMPLE
  scoop install dngrep dview pdftk winmerge paint.net smartty
#+END_EXAMPLE

*** Create starter shortcut
#+BEGIN_EXAMPLE
  . "$scoop\persist\_general\makeshortcut.ps1"
#+END_EXAMPLE
