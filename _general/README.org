* Installation instructions
#+BEGIN_EXAMPLE
Set-ExecutionPolicy RemoteSigned -Scope Process

iex (new-object net.webclient).downloadstring('https://get.scoop.sh')

pause

scoop install git
$scoop=Resolve-Path "$(scoop prefix scoop)\..\..\.."
git clone https://github.com/pcrama/windows-workstation-configuration.git -o https-origin "$scoop\persist"

scoop update
# The prior update makes the apps\scoop\current directory into a .git working directory so that we can pull into it
cd "$scoop\apps\scoop\current"
git config --local user.name "Philippe Crama"
git config --local user.email "dontsendmespam@example.com"

scoop bucket add extras

scoop bucket add scoop-buckets https://github.com/pcrama/scoop-buckets.git

pause
scoop install zip ditto fd ripgrep smallcliutils greenshot emax64-pdumper

scoop install multicommander
# Fix up some directories that are not under source control
$multicmdsrc="$scoop\apps\multicommander\current\Config.original"
$multicmdest="$scoop\persist\multicommander\Config"
Copy-Item -Path "$multicmdsrc\TOTD" -Destination "$multicmdest" -Recurse
Copy-Item -Path "$multicmdsrc\Presets" -Destination "$multicmdest" -Recurse
Copy-Item -Path "$multicmdsrc\CfgProfiles" -Destination "$multicmdest" -Recurse
# On work PC, consider adding these favorites to $multicmdest/Favorites.xml:
#    <favitem name="pcr" type="" quickid="2">\\example.com\WQA\Personal-Temp\pcr</favitem>
#    <favitem name="2<user-id> (trash)" type="" quickid="3">S:\Trash\2<user-id>\</favitem>

scoop bucket add versions
scoop install -a 32bit python27
scoop install -a 32bit tomcat

scoop install dngrep dview sumatrapdf plantuml pdftk unison workrave flux jpegview winmerge paint.net

# This one actually asks for admin credentials
scoop install hack-font

. "$scoop\persist\_general\makeshortcut.ps1"
#+END_EXAMPLE

Other apps to look at
- DoubleCmd (Lua extensibility instead of home-grown language)
- roughgrep (like dngrep but above ripgrep)
- duplicacy (encrypted cloud backup tool)

PS C:\Users\cramaph1\scoop> scoop list
Installed apps:

  7zip 18.05
  anaconda3 5.2.0 [extras]
  anki 2.1.5 [extras]
  autoit 3.3.14.5
  bat 0.7.1
  conemu 18.06.26 [extras]
  ditto 3.21.258.0 [extras]
  emax64 20180529 [scoop-buckets]
  fd 7.1.0
  flux 4.75 [extras]
  foxit-reader 9.3.0.10826 [extras]
  git 2.18.0.windows.1
  graphviz 2.38
  greenshot 1.2.10.6 [extras]
  hack-font 1.6.0 [extras]
  innounp 0.47
  keypirinha 2.19 [extras]
  meld 3.18.2 [extras]
  multicommander 8.3.0.2469 [scoop-buckets]
  plantuml 1.2018.11 [extras]
  pspad 5.0.0 [extras]
  putty 0.70 [extras]
  python27 2.7.15 [versions] {32bit}
  qemu 3.0.0
  ripgrep 0.10.0
  smallcliutils 2 [scoop-buckets]
  sumatrapdf 3.1.2 [extras]
  unison 2.48.4 [scoop-buckets]
  vcxsrv 1.20.1.3 [extras]
  virtualbox-np 5.2.18 [nonportable]
  wincompose 0.8.2 [extras]
  workrave 1.10.1 [scoop-buckets]
  zip 3.0

* Other setup actions to investigate
** TODO Setting a mouse trail
- [[https://msdn.microsoft.com/en-us/library/ms724947(v=VS.85).aspx][MSDN for SystemParametersInfo]]:
  - ~SPI_SETMOUSETRAILS~
  - ~SPI_SETMOUSESONAR~
  - ~SPI_SETMOUSEVANISH~
- [[http://www.strichnet.com/edit-and-apply-registry-settings-via-powershell/][How to call SystemParametersInfo from Powershell]]

* Tentative: Setting up with git-sdk-64
Maybe see https://github.com/lambdaheart/Haskell-Guide/blob/master/DevelopmentEnvironment.md
** Git SDK (MINGW64 + MSYS2)
#+BEGIN_EXAMPLE
  $gitZip = "git-sdk-64-master.zip"
  $gitDest = "C:\gitsdk"
  [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
  (New-Object System.Net.WebClient).DownloadFile("https://github.com/git-for-windows/git-sdk-64/archive/master.zip", $gitZip)
  Add-Type -assembly "system.io.compression.filesystem"
  [io.compression.zipfile]::ExtractToDirectory($gitZip, "C:\")
  Move-Item C:\git-sdk-64-master\ $gitDest
  & "$gitDest\msys2_shell.cmd" -msys2 -mintty -c "pacman -Syu"
  & "$gitDest\msys2_shell.cmd" -msys2 -mintty -c "pacman -Syu" # 2nd time to make sure
  & "$gitDest\msys2_shell.cmd" -msys2 -mintty -c "for p in MINGW-packages MSYS2-packages ; do sdk cd `$p ; done"
#+END_EXAMPLE

** Mingw64/Emacs installation (instead of emax64 from scoop)
1. Download/unzip https://github.com/git-for-windows/git-sdk-64/archive/master.zip
2. ~msys2_shell.cmd -mingw64 -conemu~
3. From ~msys2~:
   1. ~pacman -Syu~
   2. ~pacman -Sy mingw-w64-x86_64-hunspell{,-en} mingw-w64-x86_64-librsvg mingw-w64-x86_64-emacs~

** Scoop
*** Scoop installation & setup
#+BEGIN_EXAMPLE
  Set-ExecutionPolicy RemoteSigned -Scope Process
  iex (new-object net.webclient).downloadstring('https://get.scoop.sh')
  $Env:PATH += ";$gitDest\cmd"
  scoop update
  $scoop = Resolve-Path "$(scoop prefix scoop)\..\..\.."
  git clone https://github.com/pcrama/windows-workstation-configuration.git -o https-origin "$scoop\persist"
  cd "$scoop\persist"
  git config --local user.name "Philippe Crama"
  git config --local user.email "dontsendmespam@example.com"
  scoop bucket add extras
  scoop bucket add scoop-buckets https://github.com/pcrama/scoop-buckets.git
#+END_EXAMPLE

*** Install some apps
#+BEGIN_EXAMPLE
  scoop virustotal 7zip zip conemu ditto fd ripgrep smallcliutils greenshot keypirinha emax64 wincompose
  scoop install 7zip zip conemu ditto fd ripgrep smallcliutils greenshot keypirinha emax64 wincompose
#+END_EXAMPLE

*** Multicommander
#+BEGIN_EXAMPLE
  scoop install multicommander
  # Fix up some directories that are not under source control
  $multicmdsrc="$scoop\apps\multicommander\current\Config.original"
  $multicmdest="$scoop\persist\multicommander\Config"
  Copy-Item -Path "$multicmdsrc\TOTD" -Destination "$multicmdest" -Recurse
  Copy-Item -Path "$multicmdsrc\Presets" -Destination "$multicmdest" -Recurse
  Copy-Item -Path "$multicmdsrc\CfgProfiles" -Destination "$multicmdest" -Recurse
#+END_EXAMPLE

*** Python + Tomcat (?) 32 bit
#+BEGIN_EXAMPLE
  scoop bucket add versions
  scoop install -a 32bit python27
  # scoop install -a 32bit tomcat
#+END_EXAMPLE

*** More applications
#+BEGIN_EXAMPLE
  scoop install sumatrapdf plantuml unison workrave flux jpegview meld
#+END_EXAMPLE

*** NOT installed
#+BEGIN_EXAMPLE
  scoop install dngrep dview pdftk winmerge paint.net smartty
#+END_EXAMPLE

*** Create starter shortcut
#+BEGIN_EXAMPLE
  . "$scoop\persist\_general\makeshortcut.ps1"
#+END_EXAMPLE
* Firefox extensions
- GhostText
- Open in Browser
- Tridactyl (maybe Vim Vixen)
